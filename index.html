<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>GoHamburg Taxi - Zam贸wienie</title>
    <style>
        body { font-family: sans-serif; background: #111; color: white; padding: 20px; }
        .form { max-width: 300px; display: flex; flex-direction: column; gap: 10px; }
        input, select, button { padding: 10px; border-radius: 5px; border: none; }
        button { background: #fcd200; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <h2> Zam贸w Taxi</h2>
    <div class="form">
        <input type="text" id="discord_id" placeholder="Twoje Discord ID (same cyfry)">
        <input type="text" id="loc" placeholder="Lokalizacja (Skd)">
        <input type="text" id="dest" placeholder="Cel (Dokd)">
        <select id="cat">
            <option value="basic">Basic TAXI</option>
            <option value="green">Green TAXI</option>
            <option value="premium">Premium TAXI</option>
            <option value="classic">Classic TAXI</option>
        </select>
        <button onclick="zamow()">Wylij zlecenie</button>
    </div>

    <script>
        const sendOrder = async (orderData) => {
            // USUNITO PROXY - TERAZ CZYMY SI BEZPOREDNIO Z BOTEM
            const B_SERVER_URL = 'http://217.154.173.102:12103/api/order';

            try {
                const response = await fetch(B_SERVER_URL, {
                    method: 'POST',
                    mode: 'cors', // Wymuszamy tryb CORS
                    headers: { 
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        userId: orderData.discordId,
                        lokalizacja: orderData.loc,
                        cel: orderData.dest,
                        kategoria: orderData.cat
                    })
                });

                if (!response.ok) {
                    throw new Error('Serwer bota zwr贸ci bd: ' + response.status);
                }

                const result = await response.json();
                if (result.success) {
                    alert('Sukces! Zlecenie wysane do bota. ID: ' + result.courseId);
                } else {
                    alert('Bd bota: ' + (result.error || 'Nieznany'));
                }
            } catch (error) {
                console.error('Bd poczenia:', error);
                // Komunikat o Mixed Content i potrzebie zezwolenia na poczenie
                alert('Bd poczenia! \n\n1. Kliknij w k贸dk przy pasku adresu. \n2. Wybierz "Ustawienia witryny". \n3. Znajd藕 "Niezabezpieczona tre" i zmie na "Zezwalaj". \n4. Odwie偶 stron.');
            }
        };

        function zamow() {
            const data = {
                discordId: document.getElementById('discord_id').value,
                loc: document.getElementById('loc').value,
                dest: document.getElementById('dest').value,
                cat: document.getElementById('cat').value
            };

            if(!data.discordId || !data.loc || !data.dest) {
                return alert('Prosz wypeni wszystkie pola!');
            }
            
            // Sprawdzenie czy ID skada si z samych cyfr
            if(!/^\d+$/.test(data.discordId)) {
                return alert('Discord ID musi zawiera tylko cyfry!');
            }

            sendOrder(data);
        }
    </script>
</body>
</html>
